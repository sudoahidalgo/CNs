<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>¬øA d√≥nde vamos este martes?</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body, html {
      height: 100%;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    body {
      background: url('fondo.png') no-repeat center center fixed;
      background-size: cover;
    }
    .overlay {
      position: fixed;
      top:0; left:0; width:100vw; height:100vh;
      background: rgba(25, 25, 25, 0.62);
      z-index: 1;
      pointer-events: none;
    }
    .main-content {
      z-index: 2;
      position: relative;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
    }
    .winner-box {
      font-size: 2.1rem;
      color: #ffe066;
      font-weight: 700;
      margin-top: 1.7em;
      margin-bottom: 1.1em;
      background: rgba(0,0,0,0.45);
      padding: 0.5em 1.2em;
      border-radius: 2em;
      box-shadow: 0 2px 12px #0005;
      text-align: center;
      z-index: 3;
      min-width: 300px;
    }
    .back-btn {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 10;
      background: rgba(34,34,34,0.80);
      border-radius: 2em;
      color: #ffe066;
      padding: 0.45em 1.8em;
      font-size: 1.25em;
      font-weight: 600;
      box-shadow: 0 1px 10px #0004;
      text-decoration: none;
      transition: background 0.18s;
      display: inline-flex;
      align-items: center;
      gap: 0.7em;
    }
    .back-btn:hover { background: #4d3a18; color: #fff; }
    table {
      background: rgba(36,36,36,0.90);
      border-radius: 1.2em;
      color: #fff;
      overflow: hidden;
    }
    th, td {
      text-align: center;
      vertical-align: middle;
    }
    th {
      background: #222;
      color: #ffe066;
      font-size: 1.1em;
      letter-spacing: 1px;
    }
    .vote-btn {
      background: #008d4e;
      color: #fff;
      border-radius: 1.5em;
      font-size: 1.5em;
      padding: 6px 19px;
      border: none;
      box-shadow: 0 2px 8px #0003;
      cursor: pointer;
      transition: background 0.13s, color 0.13s;
      margin: 3px;
    }
    .vote-btn.voted {
      background: #e74c3c;
      color: #fff;
    }
    .votes-cell {
      font-size: 1.2em;
      font-weight: 700;
    }
    @media (max-width: 700px) {
      .main-content { padding: 2vw; }
      table { font-size: 0.93em; }
      .winner-box { font-size: 1.13em; min-width: 100px; }
    }
  </style>
</head>
<body>
  <div class="overlay"></div>
  <a href="index.html" class="back-btn">‚¨ÖÔ∏è Volver</a>
  <div class="main-content">
    <div id="winner" class="winner-box" style="display:none"></div>
    <h2 class="mb-4 mt-2" style="color:#ffe066; text-shadow: 2px 3px 8px #0008; font-size:2rem; font-weight:700;">¬øA d√≥nde vamos este martes?</h2>
    <!-- Tabla de votos -->
    <div class="table-responsive" style="width:100%;max-width:700px;">
      <table class="table table-dark table-hover align-middle mt-2">
        <thead>
          <tr>
            <th>Lugar</th>
            <th>Instagram / Facebook</th>
            <th>Votar</th>
            <th>Votos</th>
          </tr>
        </thead>
        <tbody id="bars-tbody">
          <!-- Aqu√≠ se rellena con JS -->
        </tbody>
      </table>
    </div>
  </div>
  <script>
    // --------- Bares y links (puedes editar aqu√≠) ----------
    const bars = [
      { name: "Hooligans Alas", ig: "https://www.instagram.com/hooligans_cr/" },
      { name: "Distrito Federal (‚ÄúDF‚Äù)", fb: "https://www.facebook.com/distritofederalcr/" },
      { name: "Old West", ig: "" },
      { name: "El Jard√≠n", ig: "https://www.instagram.com/el_jardin_bar_y_restaurante/" },
      { name: "Stiefel", ig: "https://www.instagram.com/stiefelpubcr/" },
      { name: "CRCC", ig: "https://www.instagram.com/elcountrycr/" },
      { name: "Pocket", ig: "https://www.instagram.com/pocketcostarica/" },
      { name: "La Planta", ig: "https://www.instagram.com/laplantacrcb/" },
      { name: "Rio de J", ig: "https://www.instagram.com/rioescazu/" },
      { name: "Tap House City", ig: "https://www.instagram.com/taphousecr/" },
      { name: "Eremita", ig: "https://www.instagram.com/eremita.cerveza/" },
      { name: "Zompopas", ig: "" },
      { name: "Casa Adri√°n" },
      { name: "Casa Nino" }
    ];

    // ------------ Simulaci√≥n de votos (reemplaza con fetch de tu DB/Supabase) -------------
    let votes = bars.map(bar => ({
      name: bar.name,
      votes: Math.floor(Math.random() * 6) // ¬°Reemplaza esto con tus datos!
    }));

    // ------------ Render de tabla y ganador ----------------
    function renderTable() {
      const tbody = document.getElementById('bars-tbody');
      tbody.innerHTML = '';
      votes.forEach((bar, idx) => {
        let igCell = '';
        if (bars[idx].ig) igCell = `<a href="${bars[idx].ig}" target="_blank" style="color:#ffe066;font-weight:600;">IG</a>`;
        else if (bars[idx].fb) igCell = `<a href="${bars[idx].fb}" target="_blank" style="color:#6d9be8;font-weight:600;">FB</a>`;
        else igCell = '<span style="color:#bbb;">Sin IG</span>';

        tbody.innerHTML += `
          <tr>
            <td>${bar.name}</td>
            <td>${igCell}</td>
            <td>
              <button class="vote-btn" onclick="vote('${bar.name}', this)">
                üí™
              </button>
            </td>
            <td class="votes-cell">${bar.votes}</td>
          </tr>
        `;
      });
      showWinner();
    }

    // ------------ Votaci√≥n (simulada, reemplazar por l√≥gica real) -------------
    function vote(barName, btn) {
      // Aqu√≠ ir√≠a tu l√≥gica para grabar el voto en Supabase con IP
      // Simulaci√≥n: sumar voto local y cambiar color bot√≥n
      let bar = votes.find(v => v.name === barName);
      if (bar) {
        bar.votes += 1;
        btn.classList.add("voted");
        btn.innerHTML = "üç∫";
        btn.disabled = true;
        renderTable();
      }
    }

    // ----------- Mostrar ganador/empate arriba --------------
    function showWinner() {
      const winnerDiv = document.getElementById("winner");
      const maxVotes = Math.max(...votes.map(b => b.votes));
      if (maxVotes === 0) {
        winnerDiv.style.display = "none";
        return;
      }
      const winners = votes.filter(b => b.votes === maxVotes);
      if (winners.length === 1) {
        winnerDiv.innerHTML = `üçª Ganador: <b>${winners[0].name}</b> üçª`;
      } else {
        const names = winners.map(w => `<b>${w.name}</b>`).join(", ");
        winnerDiv.innerHTML = `üçª Empate entre: ${names} üçª`;
      }
      winnerDiv.style.display = "block";
    }

    // ---- Inicializar -----
    renderTable();
  </script>
</body>
</html>
